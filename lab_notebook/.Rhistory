setwd("/Volumes/Seagate Backup Plus Drive/working_files/current_research/CPOM_Flux/lab_notebook")
library("lmerTest", lib.loc="~/Library/R/3.1/library")
Eratio <- read.table("./data/CPOM_Flux_Eratio.csv", header = T, sep = ",")
sratio <- read.table("./data/CPOM_Flux_sratio.csv", header = T, sep = ",")
sratio.mod <- lmer(s.ratio ~ 1 + elapsed.d * CPOM * nutrient + (1 + elapsed.d|bod), sratio)
sratio.mod <- lmer(s.ratio ~ 1 + elapsed.d * CPOM * Nutrient + (1 + elapsed.d|bod), sratio)
summary(sratio.mod)
anova(sratio.mod)
sratio.CPOM <- with(sratio, as.numeric(tapply(s.ratio[CPOM == "yes"], elapsed.d[CPOM == "yes"], mean)))
sratio.noCPOM <- with(sratio, as.numeric(tapply(s.ratio[CPOM == "no"], elapsed.d[CPOM == "no"], mean)))
elapsed.d.offset1 <- sratio$elapsed.d + 1
plot(s.ratio ~ elapsed.d, data = sratio, subset = CPOM == "yes", ylim = c(0.8, 1.5), xlim = c(0, 22), pch = 1)
points(sratio.CPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 16)
points(sratio.noCPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 17)
points(s.ratio ~ elapsed.d.offset1, data = sratio, subset = CPOM == "no", pch = 2)
elapsed.d.offsetneg1 <- sratio$elapsed.d - 1
plot(s.ratio ~ elapsed.d.offsetneg1, data = sratio, subset = CPOM == "yes", ylim = c(0.8, 1.5), xlim = c(0, 22), pch = 1)
plot(s.ratio ~ elapsed.d.offsetneg1, data = sratio, subset = CPOM == "yes", ylim = c(0.8, 1.5), xlim = c(-1, 22), pch = 1)
points(sratio.CPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 16)
points(sratio.noCPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 17)
points(s.ratio ~ elapsed.d.offset1, data = sratio, subset = CPOM == "no", pch = 2)
par(las = 1)
plot(s.ratio ~ elapsed.d.offsetneg1, data = sratio, subset = CPOM == "yes", ylim = c(0.8, 1.5), xlim = c(-1, 22), pch = 1)
points(sratio.CPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 16, cex = 2)
points(sratio.noCPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 17)
points(s.ratio ~ elapsed.d.offset1, data = sratio, subset = CPOM == "no", pch = 2)
plot(sratio.mod)
plot(sratio.mod, main = "sratio.mod")
dev.copy(jpeg, "./output/plots/sratio_resid_fitted.jpg")
dev.off()
qqnorm(resid(sratio.mod))
qqnorm(resid(sratio.mod), main = "sratio.mod")
dev.copy(jpeg, "./output/plots/sratio_qqnorm_resid.jpg")
dev.off()
abline(0, 1)
abline(0, .1)
abline(0, .1, col = 2)
qqnorm(resid(sratio.mod), main = "sratio.mod")
dev.copy(jpeg, "./output/plots/sratio_qqnorm_resid.jpg")
dev.off()
elapsed.d.offsetpos <- sratio$elapsed.d + 0.25
elapsed.d.offsetneg <- sratio$elapsed.d -0.25
par(las = 1)
plot(s.ratio ~ elapsed.d.offsetneg, data = sratio, subset = CPOM == "yes", ylim = c(0.8, 1.5), xlim = c(-1, 22), pch = 1)
points(sratio.CPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 16, cex = 1.5)
points(sratio.noCPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 17, cex = 1.5)
points(s.ratio ~ elapsed.d.offsetpos, data = sratio, subset = CPOM == "no", pch = 2)
par(las = 1)
plot(s.ratio ~ elapsed.d.offsetneg, data = sratio, subset = CPOM == "yes", ylim = c(0, 1.5), xlim = c(-1, 22), pch = 1, xlab = "Days of Incubation", ylab = expression(paste("S"[R])), cex.lab = 1.5, cex.axis = 1.5, cex = 2)
points(sratio.CPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 16, cex = 1.5)
points(sratio.noCPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 17, cex = 1.5)
points(s.ratio ~ elapsed.d.offsetpos, data = sratio, subset = CPOM == "no", pch = 2)
par(las = 1, mar = c(5, 5, 2, 2))
plot(s.ratio ~ elapsed.d.offsetneg, data = sratio, subset = CPOM == "yes", ylim = c(0.5, 1.5), xlim = c(-1, 22), pch = 1, xlab = "Days of Incubation", ylab = expression(paste("S"[R])), cex.lab = 1.5, cex.axis = 1, cex = 1.2)
points(sratio.CPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 16, cex = 1.5)
points(sratio.noCPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 17, cex = 1.5)
points(s.ratio ~ elapsed.d.offsetpos, data = sratio, subset = CPOM == "no", pch = 2)
par(las = 1, mar = c(5, 5, 2, 2))
plot(s.ratio ~ elapsed.d.offsetneg, data = sratio, subset = CPOM == "yes", ylim = c(0.5, 1.5), xlim = c(-1, 22), pch = 1, xlab = "Days of Incubation", ylab = expression(paste("S"[R])), cex.lab = 1.5, cex.axis = 1.3, cex = 2)
points(sratio.CPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 16, cex = 2)
points(sratio.noCPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 17, cex = 2)
points(s.ratio ~ elapsed.d.offsetpos, data = sratio, subset = CPOM == "no", pch = 2, cex = 2)
par(las = 1, mar = c(5, 5, 2, 2))
plot(s.ratio ~ elapsed.d.offsetneg, data = sratio, subset = CPOM == "yes", ylim = c(0.5, 1.5), xlim = c(-1, 22), pch = 1, xlab = "Days of Incubation", ylab = expression(paste("S"[R])), cex.lab = 1.5, cex.axis = 1.3, cex = 1.5)
points(sratio.CPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 16, cex = 1.5)
points(sratio.noCPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 17, cex = 1.5)
points(s.ratio ~ elapsed.d.offsetpos, data = sratio, subset = CPOM == "no", pch = 2, cex = 1.5)
legend(15, 1.5, c("Leaf Litter", "No Leaf Litter"), pch = (16, 17), cex =1)
legend(15, 1.5, c("Leaf Litter", "No Leaf Litter"), pch = c(16, 17), cex =1)
par(las = 1, mar = c(5, 5, 2, 2))
plot(s.ratio ~ elapsed.d.offsetneg, data = sratio, subset = CPOM == "yes", ylim = c(0.5, 1.5), xlim = c(-1, 22), pch = 1, xlab = "Days of Incubation", ylab = expression(paste("S"[R])), cex.lab = 1.5, cex.axis = 1.3, cex = 1.5)
points(sratio.CPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 16, cex = 1.5)
points(sratio.noCPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 17, cex = 1.5)
points(s.ratio ~ elapsed.d.offsetpos, data = sratio, subset = CPOM == "no", pch = 2, cex = 1.5)
legend(10, 1.5, c("Leaf Litter", "No Leaf Litter"), pch = c(16, 17), cex =1)
par(las = 1, mar = c(5, 5, 2, 2))
plot(s.ratio ~ elapsed.d.offsetneg, data = sratio, subset = CPOM == "yes", ylim = c(0.5, 1.5), xlim = c(-1, 22), pch = 1, xlab = "Days of Incubation", ylab = expression(paste("S"[R])), cex.lab = 1.5, cex.axis = 1.3, cex = 1.5)
points(sratio.CPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 16, cex = 1.5)
points(sratio.noCPOM ~ c(0, 2, 7, 14, 21), type = "b", pch = 17, cex = 1.5)
points(s.ratio ~ elapsed.d.offsetpos, data = sratio, subset = CPOM == "no", pch = 2, cex = 1.5)
legend(10, 1.5, c("Leaf Litter", "No Leaf Litter"), pch = c(16, 17), cex =1)
dev.copy(jpeg, "./output/plots/sratio_by_days.jpg")
dev.off()
