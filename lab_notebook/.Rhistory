setwd("/Volumes/Seagate Backup Plus Drive/working_files/current_research/CPOM_Flux/lab_notebook")
sod <- read.table("./data/CPOM_Flux_SOD.csv", header = T, sep = ",")
CPOM.aov <- (aov(sod.OM ~ days.elap * CPOM + Error(as.factor(bod)/days.elap), data = sod))
summary(CPOM.aov)
CPOM.aov <- (aov(sod.OM ~ days.elap + Error(as.factor(bod)/CPOM), data = sod))
summary(CPOM.aov)
CPOM.aov <- (aov(sod.OM ~ CPOM * nutrient + days.elap + Error(as.factor(bod)/(CPOM * nutrient)), data = sod))
summary(CPOM.aov)
CPOM.aov <- (aov(sod.OM ~ CPOM * nutrient * days.elap + Error(as.factor(bod)/(CPOM * nutrient)), data = sod))
summary(CPOM.aov)
Nj        <- 10                               # number of subjects per sex
P         <- 2                                # number of levels for IV sex
Q         <- 3                                # number of levels for IV stimulus
R         <- 2                                # number of levels for IV condition
subject   <- factor(rep(1:(P*Nj), times=Q*R)) # subject id
sex       <- factor(rep(1:P, times=Q*R*Nj), labels=c("F", "M")) # IV sex
stimulus  <- factor(rep(1:Q, each=P*R*Nj))    # IV stimulus
condition <- factor(rep(rep(1:R, each=P*Nj), times=Q), labels=c("EXP1", "EXP2"))
DV_t11    <- round(rnorm(P*Nj,  8, 2), 2)     # responses for stimulus=1 and condition=1
DV_t21    <- round(rnorm(P*Nj, 13, 2), 2)     # responses for stimulus=2 and condition=1
DV_t31    <- round(rnorm(P*Nj, 13, 2), 2)
DV_t12    <- round(rnorm(P*Nj, 10, 2), 2)
DV_t22    <- round(rnorm(P*Nj, 15, 2), 2)
DV_t32    <- round(rnorm(P*Nj, 15, 2), 2)
response  <- c(DV_t11, DV_t12, DV_t21, DV_t22, DV_t31, DV_t32)       # all responses
dfL       <- data.frame(subject, sex, stimulus, condition, response) # long format
dfl
dfL
summary(aov(response ~ sex*stimulus*condition + Error(subject/(stimulus*condition)), data=dfL))
CPOM.aov <- (aov(sod.OM ~ CPOM * nutrient * days.elap + Error(as.factor(bod)/days.elap), data = sod))
summary(CPOM.aov)
require(lme4)
install.packages("lme4")
library("lme4", lib.loc="~/Library/R/3.1/library")
ls()
load(Dyestuff)
load("Dyestuff")
library(lme4)
ls()
attach(lme4)
library("lattice", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
CPOM.aov <- (aov(sod.OM ~ CPOM * nutrient * days.elap + Error(as.factor(bod)/days.elap), data = sod))
sod <- read.table("./data/CPOM_Flux_SOD.csv", header = T, sep = ",")
CPOM.aov <- (aov(sod.OM ~ CPOM * nutrient * days.elap + Error(as.factor(bod)/days.elap), data = sod))
summary(CPOM.aov)
(CPOM.aov <- (aov(sod.OM ~ CPOM * nutrient * days.elap + Error(as.factor(bod)/days.elap), data = sod)))
(fm <- lmer(sod.OM ~ 1 + days.elap + (1 + days.elap|as.factor(bod)), sod))
(fm <- lmer(sod.OM ~ 1 + days.elap + (1 + days.elap|as.factor(bod)), data = sod))
(fm <- lmer(sod.OM ~ 1 + days.elap + (1 + days.elap|bod), data = sod))
sod10 <- read.table("./data/sod_calculation_10jun2014.csv", header = T, sep = ",")
sod12 <- read.table("./data/sod_calculation_12jun2014.csv", header = T, sep = ",")
sod17 <- read.table("./data/sod_calculation_17jun2014.csv", header = T, sep = ",")
sod24 <- read.table("./data/sod_calculation_24jun2014.csv", header = T, sep = ",")
sod01 <- read.table("./data/sod_calculation_1jul2014.csv", header = T, sep = ",")
botOM <- read.table("./data/CPOM_flux_bottleOM_initial.csv", header = T, sep = ",")
## Data Analysis
## 10 June 2014 Run
### Merge sediment OM calculation to SOD
sod10 <- merge(sod10, botOM, by.x = "CPOM", by.y = "CPOM")
### Normalize flux to sediment OM and time
mmol.h10 <- sod10$dDO / sod10$incubation.h
mmol.h.OM10 <- mmol.h10 / sod10$tot.OM
## convert to umol to make easier to read
umol.h.OM10 <- mmol.h.OM10 * 1000
### Summarize OM normalized Data
sod12 <- merge(sod12, botOM, by.x = "CPOM", by.y = "CPOM")
### Normalize flux to sediment OM and time
mmol.h12 <- sod12$dDO / sod12$incubation.h
mmol.h.OM12 <- mmol.h12 / sod12$tot.OM
## convert to umol to make easier to read
umol.h.OM12 <- mmol.h.OM12 * 1000
### Summarize OM normalized Data
sod17 <- merge(sod17, botOM, by.x = "CPOM", by.y = "CPOM")
### Normalize flux to sediment OM and time
mmol.h17 <- sod17$dDO / sod17$incubation.h
mmol.h.OM17 <- mmol.h17 / sod17$tot.OM
## convert to umol to make easier to read
umol.h.OM17 <- mmol.h.OM17 * 1000
sod24 <- merge(sod24, botOM, by.x = "CPOM", by.y = "CPOM")
### Normalize flux to sediment OM and time
mmol.h24 <- sod24$dDO / sod24$incubation.h
mmol.h.OM24 <- mmol.h24 / sod24$tot.OM
## convert to umol to make easier to read
umol.h.OM24 <- mmol.h.OM24 * 1000
sod01 <- merge(sod01, botOM, by.x = "CPOM", by.y = "CPOM")
### Normalize flux to sediment OM and time
mmol.h01 <- sod01$dDO / sod01$incubation.h
mmol.h.OM01 <- mmol.h01 / sod01$tot.OM
## convert to umol to make easier to read
umol.h.OM01 <- mmol.h.OM01 * 1000
### Summarize OM normalized Data
summary(umol.h.OM01)
~~~~
sum.OMflux <- umol.h.OM10 + umol.h.OM12 + umol.h.OM17 + umol.h.OM24 + umol.h.OM01
mean.OMflux <- sum.OMflux / 5
### Summarize Mean OM Normalized Data
### Compare mean OM normalized SOD by treatment
anova(lm(mean.OMflux ~ CPOM * nutrient, data = sod17))
mean.OMflux <- sum.OMflux / 5
sum.OMflux <- umol.h.OM10 + umol.h.OM12 + umol.h.OM17 + umol.h.OM24 + umol.h.OM01
mean.OMflux <- sum.OMflux / 5
### Summarize Mean OM Normalized Data
### Compare mean OM normalized SOD by treatment
anova(lm(mean.OMflux ~ CPOM * nutrient, data = sod17))
hist(residuals(lm(SOD ~ CPOM * nutrient, data = sod17)))
sod.tot <- rbind(sod10, sod12, sod17, sod24, sod01)
date <- c(rep("2014-06-10", 16), rep("2014-06-12", 16), rep("2014-06-17", 16), rep("2014-06-24", 16), rep("2014-07-01", 16))
sod.tot <- data.frame(date, sod.tot)
#### Determine days elapsed
days10 <- as.numeric(difftime(sod.tot$date[sod.tot$date == "2014-06-10"], sod.tot$date[sod.tot$date == "2014-06-10"], units = "days"))
days12 <- as.numeric(difftime(sod.tot$date[sod.tot$date == "2014-06-12"], sod.tot$date[sod.tot$date == "2014-06-10"], units = "days"))
days17 <- as.numeric(difftime(sod.tot$date[sod.tot$date == "2014-06-17"], sod.tot$date[sod.tot$date == "2014-06-10"], units = "days"))
days24 <- as.numeric(difftime(sod.tot$date[sod.tot$date == "2014-06-24"], sod.tot$date[sod.tot$date == "2014-06-10"], units = "days"))
days01 <- as.numeric(difftime(sod.tot$date[sod.tot$date == "2014-07-01"], sod.tot$date[sod.tot$date == "2014-06-10"], units = "days"))
days.elap <- c(days10, days12, days17, days24, days01)
sod.tot <- data.frame(sod.tot, days.elap)
sod.OM.bot <- sod.tot$dDO/sod.tot$tot.OM
sod.OM.h <- sod.OM.bot/sod.tot$incubation.h
sod.OM.mmol <- sod.OM.h * 24
sod.OM <- sod.OM.mmol * 1000 # flux in umol O2 / g OM / d
sod.tot$bod <- as.factor(sod.tot$bod)
sod.tot <- data.frame(sod.tot, sod.OM)
write.table(sod.tot, "./data/CPOM_Flux_SOD.csv", quote = F, row.names = F, sep = ",")
sod <- read.table("./data/CPOM_Flux_SOD.csv", header = T, sep = ",")
sod <- read.table("./data/CPOM_Flux_SOD.csv", header = T, sep = ",")
# convert bod from `int` to `Factor`
sod$bod <- as.factor(sod$bod)
CPOM.aov <- (aov(sod.OM ~ CPOM * nutrient * days.elap + Error(bod/days.elap), data = sod))
summary(CPOM.aov)
(fm <- lmer(sod.OM ~ 1 + days.elap + (1 + days.elap|bod), sod))
anova(fm)
(fm <- lmer(sod.OM ~ 1 + days.elap + (1 + days.elap|bod), sod))
anova(fm)
(fm <- lmer(sod.OM ~ 1 + days.elap * CPOM * nutrient + (1 + days.elap|bod), sod))
anova(fm)
summary(fm)
(fm <- lmer(sod.OM ~ days.elap + (1 + days.elap|bod), sod))
summary(fm)
(fm <- lmer(sod.OM ~ 1 + days.elap * CPOM * nutrient + (1 + days.elap|bod), sod))
(fm <- lmer(sod.OM ~ days.elap * CPOM * nutrient + (1 + days.elap|bod), sod))
anova(fm)
summary(fm)
lmerTest(fm)
library(lmerTest)
install.packages("lmerTest")
library("lmerTest", lib.loc="~/Library/R/3.1/library")
rand(fm)
detach("package:lmerTest", unload=TRUE)
rand(fm)
anova(fm)
(fm <- lmer(sod.OM ~ days.elap + (1 + days.elap|bod), sod))
anova(fm)
library("lmerTest", lib.loc="~/Library/R/3.1/library")
(fm <- lmer(sod.OM ~ 1 + days.elap * CPOM * nutrient + (1 + days.elap|bod), sod))
anova(fm)
(fm <- lmer(sod.OM ~ 1 + days.elap * CPOM * nutrient + (1 + days.elap|bod), sod))
anova(fm)
summary(fm)
anova(fm, ddf = "lme4")
plot(fm)
nut <- read.table("./data/CPOM_Flux_Nutrient_Flux_calc.csv", header = T, sep = ",")
BOD <- 1:16
nut <- data.frame(BOD, nut)
nut$days <- as.factor(nut$days)
fm.NOx <- lmer(NOx ~ 1 + days * CPOM * NUT + (1 + days | BOD)
)
fm.NOx <- lmer(NOx ~ 1 + days * CPOM * NUT + (1 + days | BOD), data = nut)
bod
nut
sod <- read.table("./data/CPOM_Flux_SOD.csv", header = T, sep = ",")
# convert bod from `int` to `Factor`
sod$bod <- as.factor(sod$bod)
nut <- data.frame(BOD, nut)
nut <- read.table("./data/CPOM_Flux_Nutrient_Flux_calc.csv", header = T, sep = ",")
BOD <- 1:16
nut <- data.frame(BOD, nut)
### Nitrate and Nitrite
fm.NOx <- lmer(NOx ~ 1 + days * CPOM * NUT + (1 + days | BOD), data = nut)
summary(fm.NOx)
anova(fm.NOx)
plot(fm.NOx)
fm.NH4 <- lmer(NH4 ~ 1 + days * CPOM * NUT + (1 + days | BOD), data = nut)
fm.NH3 <- lmer(NH3 ~ 1 + days * CPOM * NUT + (1 + days | BOD), data = nut)
anova(fm.NH3)
plot(fm.NH3)
fm.P <- lmer(P ~ 1 + days * CPOM * NUT + (1 + days | BOD), data = nut)
anova(fm.P)
plot(fm.P)
summary(fm.NH3)
summary(fm.NOx)
summary(fm.P)
anova(fm.P)
(fm <- lmer(sod.OM ~ 1 + days.elap * CPOM * nutrient + (1 + days.elap|bod), sod))
sod <- read.table("./data/CPOM_Flux_SOD.csv", header = T, sep = ",")
# convert bod from `int` to `Factor`
sod$bod <- as.factor(sod$bod)
(fm <- lmer(sod.OM ~ 1 + days.elap * CPOM * nutrient + (1 + days.elap|bod), sod))
(fm <- lmer(sod.OM ~ 1 + days.elap * nutrient * CPOM + (1 + days.elap|bod), sod))
(fm <- lmer(sod.OM ~ 1 + days.elap * CPOM * nutrient + (1 + days.elap|bod), sod))
anova(fm)
(fm <- lmer(sod.OM ~ 1 + days.elap * nutrient * CPOM + (1 + days.elap|bod), sod))
anova(fm)
summary(fm)
(fm <- lmer(sod.OM ~ 1 + days.elap * CPOM * nutrient + (1 + days.elap|bod), sod))
summary(fm)
summary(fm.NOx)
anova(fm.NOx)
fm.NH3 <- lmer(NH3 ~ 1 + days * CPOM * NUT + (1 + days | BOD), data = nut)
summary(fm.NH3)
anova(fm.NH3)
fm.P <- lmer(P ~ 1 + days * CPOM * NUT + (1 + days | BOD), data = nut)
summary(fm.P)
anova(fm.P)
nut <- read.table("./data/CPOM_Flux_Nutrient_Flux_calc.csv", header = T, sep = ",")
par(las = 1, mar = c(5, 5, 2, 2))
plot(NOx ~ days, data = nut, subset = CPOM == "C", ylim = c(-50, 200), pch = 1, ylab = expression(paste("Nitrate Flux (mg m"^{-2}, " d"^{-1}, ")")), xlab = "Days of Incubation", cex.axis = 1.5, cex.lab = 1.5, cex = 2)
points(NOx ~ days, data = nut, subset = CPOM == "0", pch = 2, col = 1, cex = 2)
abline(h = 0, lwd = 3)
means.NOx.CPOM <- c(mean(nut$NOx[nut$CPOM == "C" & nut$days == 2]), mean(nut$NOx[nut$CPOM == "C" & nut$days == 7]), mean(nut$NOx[nut$CPOM == "C" & nut$days == 14]), mean(nut$NOx[nut$CPOM == "C" & nut$days == 21]))
means.NOx.NCPOM <- c(mean(nut$NOx[nut$CPOM == "0" & nut$days == 2]), mean(nut$NOx[nut$CPOM == "0" & nut$days == 7]), mean(nut$NOx[nut$CPOM == "0" & nut$days == 14]), mean(nut$NOx[nut$CPOM == "0" & nut$days == 21]))
points(unique(nut$days), means.NOx.CPOM, type = "b", pch = 16, cex = 2.5)
points(unique(nut$days), means.NOx.NCPOM, type = "b", pch = 17, col = 1, cex = 2.5)
legend(10, 200, c("Leaf Litter ", "No Leaf Litter "), pch = c(16, 17), col = c(1, 1), cex = 1.5)
dev.copy(png, "./output/plots/CPOM_Flux_NOx_flux.png")
dev.off()
par(las = 1, mar = c(5, 5, 2, 2))
plot(NH3 ~ days, data = nut, subset = CPOM == "C", ylim = c(-5, 10), pch = 1, ylab = expression(paste("Ammonium Flux (mg m"^{-2}, " d"^{-1}, ")")), xlab = "Days of Incubation", cex.lab = 1.5, cex.axis = 1.5, cex = 2)
points(NH3 ~ days, data = nut, subset = CPOM == "0", pch = 2, col = 1, cex = 2)
abline(h = 0, lwd = 3)
means.NH3.CPOM <- c(mean(nut$NH3[nut$CPOM == "C" & nut$days == 2]), mean(nut$NH3[nut$CPOM == "C" & nut$days == 7]), mean(nut$NH3[nut$CPOM == "C" & nut$days == 14]), mean(nut$NH3[nut$CPOM == "C" & nut$days == 21]))
means.NH3.NCPOM <- c(mean(nut$NH3[nut$CPOM == "0" & nut$days == 2]), mean(nut$NH3[nut$CPOM == "0" & nut$days == 7]), mean(nut$NH3[nut$CPOM == "0" & nut$days == 14]), mean(nut$NH3[nut$CPOM == "0" & nut$days == 21]))
points(unique(nut$days), means.NH3.CPOM, type = "b", pch = 16, cex = 2.5)
points(unique(nut$days), means.NH3.NCPOM, type = "b", pch = 17, cex = 2.5, col = 1)
legend(10, 10, c("Leaf Litter ", "No Leaf Litter "), pch = c(16, 17), col = c(1, 1), cex = 1.5)
dev.copy(png, "./output/plots/CPOM_Flux_NH3_flux.png")
dev.off()
par(las = 1, mar = c(5, 5, 2, 2))
plot(P ~ days, data = nut, subset = CPOM == "C", ylim = c(-0.5, 1), pch = 1, ylab = expression(paste("Ortho-phosphate Flux (mg m"^{-2}, " d"^{-1}, ")")), xlab = "Days of Incubation", cex.lab = 1.5, cex.axis = 1.5, cex = 2)
points(P ~ days, data = nut, subset = CPOM == "0", pch = 2, col = 1, cex = 2)
abline(h = 0, lwd = 3)
means.P.CPOM <- c(mean(nut$P[nut$CPOM == "C" & nut$days == 2]), mean(nut$P[nut$CPOM == "C" & nut$days == 7]), mean(nut$P[nut$CPOM == "C" & nut$days == 14]), mean(nut$P[nut$CPOM == "C" & nut$days == 21]))
means.P.NCPOM <- c(mean(nut$P[nut$CPOM == "0" & nut$days == 2]), mean(nut$P[nut$CPOM == "0" & nut$days == 7]), mean(nut$P[nut$CPOM == "0" & nut$days == 14]), mean(nut$P[nut$CPOM == "0" & nut$days == 21]))
points(unique(nut$days), means.P.CPOM, type = "b", pch = 16, cex = 2.5)
points(unique(nut$days), means.P.NCPOM, type = "b", pch = 17, cex = 2.5)
legend(10, 1, c("Leaf Litter ", "No Leaf Litter "), pch = c(16, 17), col = c(1, 1), cex = 1.5)
dev.copy(png, "./output/plots/CPOM_Flux_P_flux.png")
dev.off()
par(las = 1, mar = c(5, 5, 2, 2))
plot(NH3 ~ days, data = nut, subset = CPOM == "C", ylim = c(-5, 10), pch = 1, ylab = expression(paste("Ammonium Flux (mg m"^{-2}, " d"^{-1}, ")")), xlab = "Days of Incubation", cex.lab = 1.5, cex.axis = 1.5, cex = 2)
points(NH3 ~ days, data = nut, subset = CPOM == "0", pch = 2, col = 1, cex = 2)
abline(h = 0, lwd = 3)
means.NH3.CPOM <- c(mean(nut$NH3[nut$CPOM == "C" & nut$days == 2]), mean(nut$NH3[nut$CPOM == "C" & nut$days == 7]), mean(nut$NH3[nut$CPOM == "C" & nut$days == 14]), mean(nut$NH3[nut$CPOM == "C" & nut$days == 21]))
means.NH3.NCPOM <- c(mean(nut$NH3[nut$CPOM == "0" & nut$days == 2]), mean(nut$NH3[nut$CPOM == "0" & nut$days == 7]), mean(nut$NH3[nut$CPOM == "0" & nut$days == 14]), mean(nut$NH3[nut$CPOM == "0" & nut$days == 21]))
points(unique(nut$days), means.NH3.CPOM, type = "b", pch = 16, cex = 2.5)
points(unique(nut$days), means.NH3.NCPOM, type = "b", pch = 17, cex = 2.5, col = 1)
legend(10, 10, c("Leaf Litter ", "No Leaf Litter "), pch = c(16, 17), col = c(1, 1), cex = 1)
dev.copy(png, "./output/plots/CPOM_Flux_NH3_flux.png")
dev.off()
par(las = 1, mar = c(5, 5, 2, 2))
plot(NOx ~ days, data = nut, subset = CPOM == "C", ylim = c(-50, 200), pch = 1, ylab = expression(paste("Nitrate Flux (mg m"^{-2}, " d"^{-1}, ")")), xlab = "Days of Incubation", cex.axis = 1.5, cex.lab = 1.5, cex = 2)
points(NOx ~ days, data = nut, subset = CPOM == "0", pch = 2, col = 1, cex = 2)
abline(h = 0, lwd = 3)
means.NOx.CPOM <- c(mean(nut$NOx[nut$CPOM == "C" & nut$days == 2]), mean(nut$NOx[nut$CPOM == "C" & nut$days == 7]), mean(nut$NOx[nut$CPOM == "C" & nut$days == 14]), mean(nut$NOx[nut$CPOM == "C" & nut$days == 21]))
means.NOx.NCPOM <- c(mean(nut$NOx[nut$CPOM == "0" & nut$days == 2]), mean(nut$NOx[nut$CPOM == "0" & nut$days == 7]), mean(nut$NOx[nut$CPOM == "0" & nut$days == 14]), mean(nut$NOx[nut$CPOM == "0" & nut$days == 21]))
points(unique(nut$days), means.NOx.CPOM, type = "b", pch = 16, cex = 2.5)
points(unique(nut$days), means.NOx.NCPOM, type = "b", pch = 17, col = 1, cex = 2.5)
legend(10, 200, c("Leaf Litter ", "No Leaf Litter "), pch = c(16, 17), col = c(1, 1), cex = 1)
dev.copy(png, "./output/plots/CPOM_Flux_NOx_flux.png")
dev.off()
par(las = 1, mar = c(5, 5, 2, 2))
plot(NOx ~ days, data = nut, subset = CPOM == "C", ylim = c(-50, 200), pch = 1, ylab = expression(paste("Nitrate + Nitirite Flux (mg m"^{-2}, " d"^{-1}, ")")), xlab = "Days of Incubation", cex.axis = 1.5, cex.lab = 1.5, cex = 2)
points(NOx ~ days, data = nut, subset = CPOM == "0", pch = 2, col = 1, cex = 2)
abline(h = 0, lwd = 3)
means.NOx.CPOM <- c(mean(nut$NOx[nut$CPOM == "C" & nut$days == 2]), mean(nut$NOx[nut$CPOM == "C" & nut$days == 7]), mean(nut$NOx[nut$CPOM == "C" & nut$days == 14]), mean(nut$NOx[nut$CPOM == "C" & nut$days == 21]))
means.NOx.NCPOM <- c(mean(nut$NOx[nut$CPOM == "0" & nut$days == 2]), mean(nut$NOx[nut$CPOM == "0" & nut$days == 7]), mean(nut$NOx[nut$CPOM == "0" & nut$days == 14]), mean(nut$NOx[nut$CPOM == "0" & nut$days == 21]))
points(unique(nut$days), means.NOx.CPOM, type = "b", pch = 16, cex = 2.5)
points(unique(nut$days), means.NOx.NCPOM, type = "b", pch = 17, col = 1, cex = 2.5)
legend(10, 200, c("Leaf Litter ", "No Leaf Litter "), pch = c(16, 17), col = c(1, 1), cex = 1)
dev.copy(png, "./output/plots/CPOM_Flux_NOx_flux.png")
dev.off()
par(las = 1, mar = c(5, 5, 2, 2))
plot(P ~ days, data = nut, subset = CPOM == "C", ylim = c(-0.5, 1), pch = 1, ylab = expression(paste("Ortho-phosphate Flux (mg m"^{-2}, " d"^{-1}, ")")), xlab = "Days of Incubation", cex.lab = 1.5, cex.axis = 1.5, cex = 2)
points(P ~ days, data = nut, subset = CPOM == "0", pch = 2, col = 1, cex = 2)
abline(h = 0, lwd = 3)
means.P.CPOM <- c(mean(nut$P[nut$CPOM == "C" & nut$days == 2]), mean(nut$P[nut$CPOM == "C" & nut$days == 7]), mean(nut$P[nut$CPOM == "C" & nut$days == 14]), mean(nut$P[nut$CPOM == "C" & nut$days == 21]))
means.P.NCPOM <- c(mean(nut$P[nut$CPOM == "0" & nut$days == 2]), mean(nut$P[nut$CPOM == "0" & nut$days == 7]), mean(nut$P[nut$CPOM == "0" & nut$days == 14]), mean(nut$P[nut$CPOM == "0" & nut$days == 21]))
points(unique(nut$days), means.P.CPOM, type = "b", pch = 16, cex = 2.5)
points(unique(nut$days), means.P.NCPOM, type = "b", pch = 17, cex = 2.5)
legend(10, 1, c("Leaf Litter ", "No Leaf Litter "), pch = c(16, 17), col = c(1, 1), cex = 1)
dev.copy(png, "./output/plots/CPOM_Flux_P_flux.png")
dev.off()
par(las = 1, mar = c(5, 5, 2, 2))
plot(sod.OM ~ days.elap, data = sod, subset = CPOM == "yes", ylim = c(0, 50), xlab = "Days of Incubation", ylab = expression(paste("SOD (", mu, "mol (g OM)"^{-1}, " h"^{-1}, ")")), pch = 1, col = "grey4", cex.axis = 1.5, cex.lab = 1.5, cex = 2)
points(sod.mean.CPOM ~ unique(days.elap), data = sod, type = "b", pch = 16, col = "black", cex = 2.5)
points(sod.OM ~ days.elap, data = sod, subset = CPOM == "no", pch = 2, col = "grey4", cex = 2)
points(sod.mean.ctl ~ unique(days.elap), data = sod, type = "b", pch = 17, col = "black", cex = 2.5)
legend(10, 50, c("Leaf Litter ", "No Leaf Litter "), pch = c(16, 17), cex = 1)
dev.copy(jpeg, "./output/plots/SOD_OM_by_days.jpg")
dev.off()
# Calculation of mean SOD by day and CPOM treatment for plot
sod.mean.CPOM <- c(mean(sod$sod.OM[sod$days.elap == 0 & sod$CPOM == "yes"]), mean(sod$sod.OM[sod$days.elap == 2 & sod$CPOM == "yes"]), mean(sod$sod.OM[sod$days.elap == 7 & sod$CPOM == "yes"]), mean(sod$sod.OM[sod$days.elap == 14 & sod$CPOM == "yes"]), mean(sod$sod.OM[sod$days.elap == 21 & sod$CPOM == "yes"]))
sod.mean.ctl <- c(mean(sod$sod.OM[sod$days.elap == 0 & sod$CPOM == "no"]), mean(sod$sod.OM[sod$days.elap == 2 & sod$CPOM == "no"], na.rm = T), mean(sod$sod.OM[sod$days.elap == 7 & sod$CPOM == "no"]), mean(sod$sod.OM[sod$days.elap == 14 & sod$CPOM == "no"]), mean(sod$sod.OM[sod$days.elap == 21 & sod$CPOM == "no"]))
# Plot of OM normalized SOD by days of incubation (for ASB talk)
par(las = 1, mar = c(5, 5, 2, 2))
plot(sod.OM ~ days.elap, data = sod, subset = CPOM == "yes", ylim = c(0, 50), xlab = "Days of Incubation", ylab = expression(paste("SOD (", mu, "mol (g OM)"^{-1}, " h"^{-1}, ")")), pch = 1, col = "grey4", cex.axis = 1.5, cex.lab = 1.5, cex = 2)
points(sod.mean.CPOM ~ unique(days.elap), data = sod, type = "b", pch = 16, col = "black", cex = 2.5)
points(sod.OM ~ days.elap, data = sod, subset = CPOM == "no", pch = 2, col = "grey4", cex = 2)
points(sod.mean.ctl ~ unique(days.elap), data = sod, type = "b", pch = 17, col = "black", cex = 2.5)
legend(10, 50, c("Leaf Litter ", "No Leaf Litter "), pch = c(16, 17), cex = 1)
dev.copy(jpeg, "./output/plots/SOD_OM_by_days.jpg")
dev.off()
setwd("~/current_research/CPOM_Flux/lab_notebook")
ergo <- read.table("./data/CPOM_Flux_Ergo.csv", header = T, sep = ",")
plot(fungal_biomass_per_OM ~ CPOM, data = ergo, subset = sample == "sed")
plot(fungal_mass_per_OM ~ CPOM, data = ergo, subset = sample == "sed")
plot(fungal_mass_per_OM ~ CPOM, data = ergo, subset = samp == "sed")
ergo <- read.table("./data/CPOM_Flux_Ergo.csv", header = T, sep = ",")
plot(fungal_mass_per_OM ~ CPOM, data = ergo, subset = samp == "sed")
ergo <- read.table("./data/CPOM_Flux_Ergo.csv", header = T, sep = ",")
plot(fungal_mass_per_OM ~ CPOM, data = ergo, subset = samp == "sed")
plot(fungal_mass_per_OM ~ as.numeric(CPOM), data = ergo, subset = samp == "sed")
plot(fungal_mass ~ CPOM, data = ergo, subset = samp == "sed")
plot(fungal_mass ~ as.numeric(CPOM), data = ergo, subset = samp == "sed", ylim = c(0, 0.3))
plot(fungal_mass ~ as.numeric(CPOM), data = ergo, subset = samp == "leaf", ylim = c(0, 0.3))
plot(ergo$fungal_mass[ergo$samp == "leaf"] ~ ergo$fungal_mass[ergo$samp == "sed"])
boxplot(ergo$fungal_mass[ergo$samp == "leaf"],  ergo$fungal_mass[ergo$samp == "sed"])
hist(ergo$fungal_mass[ergo$samp == "leaf"])
stem(ergo$fungal_mass[ergo$samp == "leaf"])
stem(ergo$fungal_mass[ergo$samp == "sed"])
plot(fungal_mass ~ as.numeric(nutrients), data = ergo, subset = samp == "leaf", ylim = c(0, 0.3))
plot(ergo$fungal_mass[ergo$samp == "leaf"] ~ ergo$fungal_mass[ergo$samp == "sed"])
boxplot(ergo$fungal_mass[ergo$samp == "leaf"],  ergo$fungal_mass[ergo$samp == "sed"])
plot(ergo$fungal_mass[ergo$samp == "leaf"],  ergo$fungal_mass[ergo$samp == "sed"])
boxplot(ergo$fungal_mass[ergo$samp == "leaf"],  ergo$fungal_mass[ergo$samp == "sed"])
boxplot(ergo$fungal_mass[ergo$samp == "leaf"],  ergo$fungal_mass[ergo$samp == "sed"], ylim = c(0, 0.3))
text(1, 0, "leaf")
boxplot(ergo$fungal_mass[ergo$samp == "leaf"],  ergo$fungal_mass[ergo$samp == "sed"], ylim = c(0, 0.3))
text(1, 0.02, "leaf")
text(1, 0.02, "sed")
boxplot(ergo$fungal_mass[ergo$samp == "leaf"],  ergo$fungal_mass[ergo$samp == "sed"], ylim = c(0, 0.3))
text(1, 0.02, "leaf")
text(2, 0.02, "sed")
t.test(ergo$fungal_mass[ergo$samp == "leaf"],  ergo$fungal_mass[ergo$samp == "sed"])
t.test(log(ergo$fungal_mass[ergo$samp == "leaf"]),  log(ergo$fungal_mass[ergo$samp == "sed"]))
boxplot(log(ergo$fungal_mass[ergo$samp == "leaf"]),  log(ergo$fungal_mass[ergo$samp == "sed"]))
boxplot(log10(ergo$fungal_mass[ergo$samp == "leaf"]),  log10(ergo$fungal_mass[ergo$samp == "sed"]))
boxplot(sqrt(ergo$fungal_mass[ergo$samp == "leaf"]),  sqrt(ergo$fungal_mass[ergo$samp == "sed"]))
t.test(ergo$fungal_mass[ergo$samp == "leaf"],  ergo$fungal_mass[ergo$samp == "sed"])
