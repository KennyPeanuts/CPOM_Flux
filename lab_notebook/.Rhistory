setwd("~/current_research/CPOM_Flux/lab_notebook")
spec22Sept <- read.table("./data/leached_litter_spec_22sept2015.csv", header = T, sep = ",")
spec24Sept <- read.table("./data/leached_litter_spec_24sept2015.csv", header = T, sep = ",")
spec1Oct <- read.table("./data/leached_litter_spec_1oct2015.csv", header = T, sep = ",")
spec8Oct <- read.table("./data/leached_litter_spec_8oct2015.csv", header = T, sep = ",")
spec22Oct <- read.table("./data/leached_litter_spec_22oct2015.csv", header = T, sep = ",")
spec22Oct <- read.table("./data/leached_litter_spec_22oct2015.csv", header = T, sep = ",")
spec5Nov <- read.table("./data/leached_litter_spec_5nov2015.csv", header = T, sep = ",")
spec.all <- rbind(spec22Sept, spec24Sept, spec1Oct, spec8Oct, spec22Oct, spec5Nov)
a <- (spec.all$abs * 2.303) / 0.01
spec.a <- data.frame(spec.all, a)
day <- c(rep("2015-09-22", length(spec22Sept$bod)), rep("2015-09-24", length(spec24Septt$bod)), rep("2015-10-01", length(spec1Oct$bod)), rep("2015-10-08", length(spec8Oct$bod)), rep("2015-10-22", length(spec22Oct$bod)), rep("2015-11-05", length(spec5Nov$bod)))
day <- c(rep("2015-09-22", length(spec22Sept$bod)), rep("2015-09-24", length(spec24Sept$bod)), rep("2015-10-01", length(spec1Oct$bod)), rep("2015-10-08", length(spec8Oct$bod)), rep("2015-10-22", length(spec22Oct$bod)), rep("2015-11-05", length(spec5Nov$bod)))
spec.tot <- data.frame(day, spec.a)
treat <- read.table("./data/leached_litter_treatments_fall2015.csv", header = T, sep = ",")
spec <- merge(treat, spec.tot, by = "bod")
head(spec_
)
head(spec)
E2E3.a <- spec$a[spec$wl == 250] / spec$a[spec$wl == 365]
E4E6.a <- spec$a[spec$wl == 465] / spec$a[spec$wl == 665]
bod250 <- spec$bod[spec$wl == 250]
day250 <- spec$day[spec$wl == 254]
treat250 <- spec$treat[spec$wl == 250]
Eratio <- data.frame(bod250, day250, treat250, E2E3.a, E4E6.a)
Eratio
plot(E2E3 ~ day250, data = Eratio, subset = treat250 == "L")
plot(E2E3.a ~ day250, data = Eratio, subset = treat250 == "L")
plot(E2E3.a ~ day250, data = Eratio, subset = treat250 == "LS")
plot(E2E3.a ~ day250, data = Eratio, subset = treat250 == "S")
write.table(Eratio, "./data/leached_litter_Eratio.csv", quote = F, row.names = F, sep = ",")
spec275 <- spec[spec$wl >= 275 & spec$wl <=295, ]
elapsed.d <- rep(0, length(spec275$bod))
spec275 <- data.frame(spec275, elapsed.d)
unique(spec$day)
9+5
30+14
spec275$elapsed.d[spec275$day == "2015-09-22"] <- 1
spec275$elapsed.d[spec275$day == "2015-09-24"] <- 2
spec275$elapsed.d[spec275$day == "2015-10-01"] <- 9
spec275$elapsed.d[spec275$day == "2015-10-08"] <- 16
spec275$elapsed.d[spec275$day == "2015-10-22"] <- 30
spec275$elapsed.d[spec275$day == "2015-11-05"] <- 44
spec350 <- spec[spec$wl >=350 & spec$wl <= 400, ]
elapsed.d <- rep(0, length(spec350$bod))
spec350 <- data.frame(spec350, elapsed.d)
spec350$elapsed.d[spec350$day == "2015-09-22"] <- 1
spec350$elapsed.d[spec350$day == "2015-09-24"] <- 2
spec350$elapsed.d[spec350$day == "2015-10-01"] <- 9
spec350$elapsed.d[spec350$day == "2015-10-08"] <- 16
spec350$elapsed.d[spec350$day == "2015-10-22"] <- 30
spec350$elapsed.d[spec350$day == "2015-11-05"] <- 44
# create wrapper function tp calculate the slope
lm.slope <- function(x){
coef(lm(log(a) ~ wl, data = x))[2]
}
# split the day and bod data
spl.data <- with(spec275, split(spec275, list(elapsed.d = elapsed.d, bod = bod)))
slopes <- sapply(spl.data, lm.slope)
unique(elapsed.d)
elapsed.d
unique(spec350$elapsed.d)
length(unique(spec350$elapsed.d))
bod <- c(rep(1:12, length(unique(spec350$elapsed.d))))
bod <- sort(bod)
bod <- c(rep(1:12, length(unique(spec275$elapsed.d))))
bod <- sort(bod)
elapsed.d <- rep(sort(unique(spec275$elapsed.d)), length(unique(bod))
)
spec275.slopes <- data.frame(bod, elapsed.d, slopes)
spec275.slopes
spl.data <- with(spec350, split(spec350, list(elapsed.d = elapsed.d, bod = bod)))
# get a list of the slopes
slopes <- sapply(spl.data, lm.slope)
# create data frame of the data with the slopes
# create a data frame of the elapsed day and bod
bod <- c(rep(1:12, length(unique(spec350$elapsed.d))))
bod <- sort(bod)
elapsed.d <- rep(sort(unique(spec350$elapsed.d)), length(unique(bod))
spec350.slopes <- data.frame(bod, elapsed.d, slopes)
elapsed.d <- rep(sort(unique(spec350$elapsed.d)), length(unique(bod))
elapsed.d <- rep(sort(unique(spec350$elapsed.d)), length(unique(bod)))
elapsed.d <- rep(sort(unique(spec350$elapsed.d)), length(unique(bod)))
spec350.slopes <- data.frame(bod, elapsed.d, slopes)
s.ratio.lst <- spec275.slopes$slopes / spec350.slopes$slopes
s.ratio <- data.frame(spec275.slopes$bod, spec275.slopes$elapsed.d, spec275.slopes$slopes, spec350.slopes$slopes, s.ratio.lst)
names(s.ratio) <- c("bod", "elapsed.d", "spec275.slope", "spec350.slope", "s.ratio")
s.ratio <- merge(treat, s.ratio, by = "bod")
head(s.ratio)
write.table(s.ratio, "./data/leached_litter_sratio.csv", quote = F, row.names = F, sep = ",")
plot(s.ratio ~ elapsed.d, data = s.ratio, subset = treat == "S")
plot(s.ratio ~ elapsed.d, data = s.ratio, subset = treat == "LS")
plot(s.ratio ~ elapsed.d, data = s.ratio, subset = treat == "L")
